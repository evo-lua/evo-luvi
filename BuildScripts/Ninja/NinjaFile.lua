local table_concat = table.concat

local DEFAULT_REQUIRED_VERSION = "1.11"
local DEFAULT_BUILD_DIRECTORY_NAME = "ninjabuild"

local NinjaFile = {
	requiredVersion = DEFAULT_REQUIRED_VERSION,
	buildDirectory = DEFAULT_BUILD_DIRECTORY_NAME,
	-- Untested (NYI)
	ruleDeclarations = {},
	buildEdges = {},
	variables = {},
	defaultTargets = {},
	subninjas = {},
	includes = {},
	pool = {},
}

NinjaFile.DEFAULT_REQUIRED_VERSION = DEFAULT_REQUIRED_VERSION
NinjaFile.DEFAULT_BUILD_DIRECTORY_NAME = DEFAULT_BUILD_DIRECTORY_NAME
NinjaFile.AUTOGENERATION_HEADER_TEXT = "# Automatically generated by evo-ninja (editing this file is pointless)"

function NinjaFile:Construct()
	local instance = {}

	instance.__index = self
	setmetatable(instance, instance)

	return instance
end

function NinjaFile:Save(filePath)
	local fileContents = self:ToString()
	C_FileSystem.WriteFile(filePath, fileContents)
end

function NinjaFile:ToString()
	local fileContents = {}

	fileContents[#fileContents+1] = NinjaFile.AUTOGENERATION_HEADER_TEXT

	return table_concat(fileContents, "\n")
end

NinjaFile.__call = NinjaFile.Construct
NinjaFile.__tostring = NinjaFile.ToString
setmetatable(NinjaFile, NinjaFile)

return NinjaFile